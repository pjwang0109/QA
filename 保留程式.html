$(document).ready(function () {
  let dataTable = $("#myTable").DataTable({
    // 屬性

    // 語言 (language)
    language: {
      lengthMenu: "顯示 _MENU_ 項結果",
      search: "搜尋:",
      info: "顯示 _START_ 到 _END_ 筆資料，共 _TOTAL_ 項",
    },
    // 資料欄位 (columns)
    columns: [
      { data: "userid", title: "身分證字號" },
      { data: "username", title: "姓名" },
      { data: "number", title: "電話" },
      { data: "address", title: "地址" },
      { data: "memo", title: "備註" },
    ],

    // 欄位元素 (columnDefs)

    // 列元素 (rowCallback)

    // 其他設定
  });

  // 查詢 btn 點擊事件處理程序
  $("#queryBtn").click(function () {
    // 獲取身分證字號
    let inputId = $("#id-card").val();

    // 使用Ajax向API發送請求
    $.ajax({
      url: "http://localhost:8080/training/res/S010010001",
      method: "POST",
      dataType: "json",
      contentType: "application/json",
      data: JSON.stringify({ id: inputId }), // 根據需求調整傳遞的參數
      success: function (response) {
		  // 清空 DataTable 資料
		  dataTable.clear().draw();
        // 如果API返回的資料中包含符合的身分證資料
        if(inputId === response.result.userid){
			        // 將 API 返回的資料加入 DataTable 中
			dataTable.row
          .add({
            userid: response.result.userid,
            username: response.result.username,
            number: response.result.number,
            address: response.result.address,
            memo: response.result.memo,
          })
          .draw();
          
          $("#message").text("yes 身份證字號檢碼符合")

		console.log("成功");
        console.log("response:", response);
        console.log("response 的 result:", response.result);
        console.log("userId:", response.result.userid);
		}else{
		  $("#message").text("no 身份證字號檢碼不符")
		}
      },
      error: function (error) {
        console.log("發生錯誤:", error);
      },
    });
  });
});
