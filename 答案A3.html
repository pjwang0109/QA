async function addPrimaryProductTableDataCR($triggerBtn, item) {
    const $container = $triggerBtn.closest('.card-body');
    let yearList = getYearList($container);

    // 從 item 讀取 yyy1~yyy3 取得年份，並更新 yearList（避免重複）
    for (let i = 1; i <= 3; i++) {
        const y = parseInt(item[`yyy${i}`]);
        if (!isNaN(y) && y !== 0 && !yearList.includes(y)) {
            yearList.push(y);
        }
    }
    yearList.sort((a, b) => a - b);
    setYearList($container, yearList);

    // 更新表頭
    updateTableHeader($container);

    // 新增產品資料列
    const $row = $('<tr class="product-row"></tr>');

    $row.append(`
        <td class="d-flex">
            <button class="btn btn-danger mr-2 del-pro-btn" onclick="deleteProductsUnit(this)">
                <i class="fa fa-times"></i>
            </button>
            <textarea class="form-control pname" rows="1">${item.pname || ''}</textarea>
        </td>
        <td style="vertical-align:middle" class="text-center">佔營收比</td>
    `);

    // 根據年分欄位依序塞入對應的 rratio 值
    $.each(yearList, function (i, year) {
        // 對應到 rratio 欄位是 rratio1、2、3... 依序
        const rate = item[`rratio${i + 1}`] || '';
        const rateN = i + 1;

        const $td = $(`
            <td class="year-col year-col-${year}">
                <div class="form-inline rate-${year}">
                    <input type="text" maxlength="3" style="width: 114px" 
                           class="form-control rate-input rate-${rateN}" value="${rate}" />
                    <span class="input-group-text">%</span>
                </div>
            </td>
        `);

        insertSortedColumn($row, $td, year);
    });

    $container.find('#product-body').append($row);
}
