function render401mpritemToProductTable(result) {
  const data = result["401mpritem"];
  if (!Array.isArray(data) || data.length === 0) return;

  // 找到表格 DOM
  const $table = $("#product-table");
  const $thead = $table.find("#table-header");
  const $tbody = $table.find("#product-body");

  // 清空欄位
  $thead.find(".year-header").remove();
  $tbody.empty();

  // 假設最多支援3年
  const yearSet = new Set();
  data.forEach(item => {
    if (item.yyy1) yearSet.add(item.yyy1);
    if (item.yyy2) yearSet.add(item.yyy2);
    if (item.yyy3) yearSet.add(item.yyy3);
  });

  const years = Array.from(yearSet);

  // 動態新增年份欄位到 header
  years.forEach(year => {
    $thead.append(`<th class="year-header text-center">${year} 年</th>`);
  });

  // 動態新增每一列產品資料
  data.forEach(item => {
    const $row = $(`<tr></tr>`);
    $row.append(`<td><input type="text" class="form-control pname" value="${item.pname}"/></td>`);
    $row.append(`<td><input type="text" class="form-control rratio" value=""/></td>`); // 可視情況放 rratio 合計

    // 根據年份插入對應的 rratio
    years.forEach(year => {
      let ratio = "";
      if (item.yyy1 === year) ratio = item.rratio1;
      else if (item.yyy2 === year) ratio = item.rratio2;
      else if (item.yyy3 === year) ratio = item.rratio3;

      $row.append(`<td><input type="text" class="form-control" value="${ratio}"/></td>`);
    });

    $tbody.append($row);
  });
}
