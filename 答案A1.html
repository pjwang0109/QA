json = JSON.parse(json);
let funclist = json.result.funclist;

// 生成主選單
$.each(funclist, function (key, object) {
    let menuLi = `
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="${object.sid}" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ${object.sname}
            </a>
            <div class="dropdown-menu" style="min-width: 14rem;" aria-labelledby="${object.sid}"></div>
        </li>`;

    $("#navbarSupportedContent").find(".navbar-nav.m-auto").append(menuLi);

    // 處理第二層選單
    $.each(object.child, function (key, val) {
        if (val.type == 2.5) { // 三層選單
            let tabVal = val.sid;
            let menuUrl = `
                <div class="dropdown">
                    <a class="dropdown-item1">${val.sname}</a>
                    <div class="dropdown-content">
                        <div class="dropdown${tabVal} position-relative bg-white"></div>
                    </div>
                </div>`;
            $("#" + object.sid).nextAll(".dropdown-menu").append(menuUrl);

            // 處理第三層選單
            $.each(val.child, function (item, val3) {
                if (val3.type == 3.5) { // 四層選單
                    let subTabVal = val3.sid;
                    let subMenuUrl = `
                        <div class="dropdown">
                            <a class="dropdown-item1">${val3.sname}</a>
                            <div class="dropdown-content">
                                <div class="dropdown${subTabVal} position-relative bg-white"></div>
                            </div>
                        </div>`;
                    $(".dropdown" + tabVal).append(subMenuUrl);

                    // 處理第四層選單
                    $.each(val3.child, function (item, val4) {
                        let link = `<a class="dropdown-item" href="javascript:getFunctionPage('${val4.sid.toLowerCase()}')">${val4.sname}</a>`;
                        $(".dropdown" + subTabVal).append(link);
                    });

                } else {
                    let link = `<a class="dropdown-item" href="javascript:getFunctionPage('${val3.sid.toLowerCase()}')">${val3.sname}</a>`;
                    $(".dropdown" + tabVal).append(link);
                }
            });

        } else {
            let menuUrl = `<a class="dropdown-item" href="javascript:getFunctionPage('${val.sid.toLowerCase()}')">${val.sname}</a>`;
            $("#" + object.sid).nextAll(".dropdown-menu").append(menuUrl);
        }
    });
});