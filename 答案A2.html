// 運算千分位符號，處理整數和小數點
function formatNumberWithThousands(number) {
    if (number.indexOf('.') !== -1) {
        // 分割整數和小數部分
        const splitArr = number.split(".");
        const formattedInteger = splitArr[0].replace(/(\d)(?=(?:\d{3})+$)/g, '$1,');
        return `${formattedInteger}.${splitArr[1]}`;
    } else {
        // 處理純整數
        return number.replace(/(\d)(?=(?:\d{3})+$)/g, '$1,');
    }
}

// 處理輸入內容，將文字和數字分開處理
function processTextAndNumbers(input) {
    if (input === "") return input;

    return input.replace(/(\d+(\.\d+)?)/g, function (match) {
        return formatNumberWithThousands(match);
    });
}

// 設置千分位符號
function set_money_Thousands(obj) {
    if (obj.value !== "") {
        obj.value = processTextAndNumbers(obj.value);
    }
}