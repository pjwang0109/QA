// 完成
async function btnFinishTCFD(obj) {
    loadingShow("資料處理中");
    try {
        // 取得 uid 和 token
        let userObj = getUidToken();
        let uid = userObj.uid;
        let token = userObj.token;

        // 組裝資料
        let data = {};
        let caseNo = $('.caseClimateId').val() || "";
        data.caseno = caseNo;
        data.uf_no = '';

        // 先打暫存 API
        await btnStoreTCFD(obj);

        // 再打完成 API
        let json = await apiS140020005(uid, token, data);
        if (json.rc === "M0000") {
            alert(json.msg);
            $("section").text("");
            $(".breadcrumb").text("");
        } else {
            apiErrorHandler(json);
        }
    } catch (error) {
        console.error("處理失敗：", error);
        alert("處理失敗，請稍後重試！");
    } finally {
        loadingHide();
    }
}